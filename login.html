<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Portal Santa Lúcia – Acesso</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family: Arial, Helvetica, sans-serif;
      background:#f5f5f5;
      color:#222;
      min-height:100vh;
      display:flex;
      flex-direction:column;
    }
    header{
      background:#1f4b70;
      color:#fff;
      padding:16px 24px;
      display:flex;
      align-items:center;
      gap:14px;
      flex-wrap:wrap;
    }
    header img{height:48px;width:auto;display:block}
    header .t1{font-size:18px;font-weight:700;line-height:1.2}
    header .t2{font-size:12px;opacity:.9}
    main{
      flex:1;
      max-width:520px;
      width:100%;
      margin:0 auto;
      padding:22px 16px 16px 16px;
      display:flex;
      align-items:flex-start;
      justify-content:center;
    }
    .card{
      width:100%;
      background:#fff;
      border-radius:12px;
      box-shadow:0 2px 12px rgba(0,0,0,.10);
      padding:18px 18px 16px 18px;
    }
    h2{font-size:18px;margin-bottom:6px}
    p{font-size:13px;color:#555;margin-bottom:12px;line-height:1.35}
    label{display:block;font-size:12px;color:#333;margin:10px 0 6px}
    input{
      width:100%;
      border:1px solid #d4d4d4;
      border-radius:10px;
      padding:10px 12px;
      font-size:14px;
      outline:none;
    }
    input:focus{border-color:#1f4b70; box-shadow:0 0 0 3px rgba(31,75,112,.12)}

.pass-wrap{
  position:relative;
}

.pass-wrap input{
  padding-right:46px;
}

.toggle-pass{
  position:absolute;
  right:12px;
  top:50%;
  transform:translateY(-50%);
  height:34px;
  width:34px;
  border:none;
  background:transparent;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:0;
}

.toggle-pass svg{
  width:20px;
  height:20px;
  fill:#6b7c8f;
  transition:fill .2s ease, transform .15s ease;
}

.toggle-pass:hover svg{
  fill:#1f4b70;
}

.toggle-pass:active svg{
  transform:scale(0.92);
}
.remember{
  display:flex;
  align-items:center;
  gap:8px;
  margin-top:10px;
  font-size:12px;
  color:#333;
  user-select:none;
}
.remember input{width:auto}
    .row{display:flex;gap:10px;align-items:center;margin-top:14px}
    button{
      width:100%;
      border:none;
      background:#1f4b70;
      color:#fff;
      font-weight:800;
      padding:10px 12px;
      border-radius:10px;
      cursor:pointer;
      font-size:14px;
    }
    button:hover{filter:brightness(1.03)}
    .msg{
      margin-top:10px;
      font-size:12px;
      color:#b00020;
      min-height:16px;
    }
    .hint{
      margin-top:12px;
      font-size:11px;
      color:#666;
    }
    footer{
      text-align:center;
      font-size:11px;
      color:#777;
      padding:10px 0 14px 0;
    }
  </style>
</head>
<body>
  <header>
    <img src="images/logo-site-final-2.png" alt="Santa Lúcia">
    <div>
      <div class="t1">Portal Santa Lúcia – Mapas Interativos</div>
      <div class="t2">Acesso restrito.</div>
    </div>
  </header>

  <main>
    <div class="card">
      <h2>Entrar</h2>
      <p>Informe seu login e senha para acessar o portal.</p>

      <form id="loginForm" autocomplete="off">
        <label for="user">Login</label>
        <input id="user" name="user" type="text" inputmode="text" placeholder="Digite o login" required />

        <label for="pass">Senha</label>
        <div class="pass-wrap">
          <input id="pass" name="pass" type="password" placeholder="Digite a senha" required />
          <button id="togglePass" class="toggle-pass" type="button" aria-label="Mostrar/ocultar senha" title="Mostrar/ocultar senha">
            <svg viewBox="0 0 24 24" aria-hidden="true">
              <path d="M12 5c-5.5 0-9.6 4.2-10.9 6 1.3 1.8 5.4 6 10.9 6s9.6-4.2 10.9-6C21.6 9.2 17.5 5 12 5zm0 10a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-6.5A2.5 2.5 0 1 0 12 13a2.5 2.5 0 0 0 0-5z"/>
            </svg>
          </button>
        </div>

<div class="remember">
  <input id="remember" type="checkbox" />
  <label for="remember">Lembrar senha neste dispositivo</label>
</div>

        <div class="row">
          <button type="submit">Acessar</button>
        </div>
        <div id="msg" class="msg"></div>
        <div class="hint">Obs.: por segurança, o acesso expira diariamente às <b>23:59:59</b>.</div>
      </form>
    </div>
  </main>

  <footer>EcoMap – Levantamentos aéreos com drones, mapeamentos e soluções ambientais.</footer>

<script>
(function(){
  const LOGIN = "santalucia2026";
  const PASS  = "santalucia2026";
  const KEY_AUTH = "SL_AUTH";
  const KEY_EXP  = "SL_EXPIRY";

  const KEY_REMEMBER = "SL_REMEMBER";
  const KEY_USER = "SL_USER";
  const KEY_PASS = "SL_PASS";

  function endOfDayExpiry(){
    const now = new Date();
    const exp = new Date(now);
    exp.setHours(23,59,59,999); // 23:59:59
    if(exp.getTime() <= now.getTime()){
      exp.setDate(exp.getDate()+1);
      exp.setHours(23,59,59,999);
    }
    return exp.getTime();
  }

  function getNext(){
    const p = new URLSearchParams(location.search);
    const next = p.get("next") || "index.html";
    // só permite navegar dentro do portal (sem URLs externas)
    if(next.includes("://") || next.startsWith("//")) return "index.html";
    return next;
  }

  // Se já estiver logado e válido, manda direto
  (function autoBypass(){
    let ok=false, exp=0;
    try{
      ok = sessionStorage.getItem(KEY_AUTH)==="1";
      exp = parseInt(sessionStorage.getItem(KEY_EXP)||"0",10);
    }catch(e){}
    if(ok && exp && Date.now() < exp){
      location.replace(getNext());
    }
  })();

  const form = document.getElementById("loginForm");
  const msg  = document.getElementById("msg");


const remember = document.getElementById("remember");
const passEl = document.getElementById("pass");
const userEl = document.getElementById("user");

// Preenche login/senha se "lembrar" estiver ativo (apenas neste dispositivo/navegador)
(function prefillRemembered(){
  try{
    const r = localStorage.getItem(KEY_REMEMBER) === "1";
    if(r){
      remember.checked = true;
      const lu = localStorage.getItem(KEY_USER) || "";
      const lp = localStorage.getItem(KEY_PASS) || "";
      if(lu) userEl.value = lu;
      if(lp) passEl.value = lp;
    }
  }catch(e){}
})();

// Olhinho: mostrar/ocultar senha
(function bindTogglePass(){
  const btn = document.getElementById("togglePass");
  if(!btn) return;
  btn.addEventListener("click", function(){
    const isPwd = passEl.type === "password";
    passEl.type = isPwd ? "text" : "password";
    btn.setAttribute("aria-pressed", isPwd ? "true" : "false");
  });
})();

  form.addEventListener("submit", function(e){
    e.preventDefault();
    msg.textContent = "";

    const u = (document.getElementById("user").value || "").trim();
    const p = (document.getElementById("pass").value || "");

    if(u === LOGIN && p === PASS){
      try{
        sessionStorage.setItem(KEY_AUTH, "1");
        sessionStorage.setItem(KEY_EXP, String(endOfDayExpiry()));
      }catch(err){}
      // Salvar/limpar credenciais conforme opção "lembrar"
      try{
        if(remember && remember.checked){
          localStorage.setItem(KEY_REMEMBER, "1");
          localStorage.setItem(KEY_USER, u);
          localStorage.setItem(KEY_PASS, p);
        }else{
          localStorage.removeItem(KEY_REMEMBER);
          localStorage.removeItem(KEY_USER);
          localStorage.removeItem(KEY_PASS);
        }
      }catch(e){}
      location.replace(getNext());
      return;
    }

    msg.textContent = "Login ou senha inválidos.";
  });


// UX: foco no campo correto
if((document.getElementById("user").value || "").trim() && !(document.getElementById("pass").value || "")){
  document.getElementById("pass").focus();
}else{
  document.getElementById("user").focus();
}
})();
</script>
</body>
</html>
